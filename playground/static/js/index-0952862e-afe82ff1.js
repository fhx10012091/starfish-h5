import{d as k,R as l,S as b,U as j,r as h,V as T,o as F,W as V,X as B,Y as P,z as S,a as _,b as y,j as i,l as C,q as D,f as q,w as n,n as v,k as J,h as d,B as w,Z as M,M as W,E as $,N as x,v as z}from"./main-837926ce.js";/* empty css                */import{J as N}from"./jsoneditor.min-c31b3273.js";const O=k({ControlType:"JsonEditor",nameCn:"JSON编辑",icon:"icon-json-full",rule:l.getJsonValidate(),formConfig:b("JsonEditor",[{fieldName:"default",component:"JsonEditor"}]),props:{...j},actionType:["onChange"],setup(e){const c=h({});let m=null,a=null;const u=h(),r=h();T(e);function f(){const t=c.value,s=e.data,o=e.item,g=o.data.fieldName,p={modes:["text","code","view"],mode:"code",search:!1,onChange(){s[g]=a?.getText()}};a=new N(t,p),e.drag?a?.set(l.tryParseJson(o.data.default)):a?.set(l.tryParseJson(s[o.data.fieldName]))}return F(()=>{f()}),V(()=>e.item,t=>{if(e.drag)a?.set(l.tryParseJson(t.data.default));else{const s=e.data,o=e.item;a?.set(l.tryParseJson(s[o.data.fieldName]))}}),{myDialog:r,jsoneditor:c,JsonViewerDialogDom:u,async showCustomDialog(){const t=r.value;t.show(),t.init("JSON编辑","icon-json-full"),await B();const s=u.value,o={modes:["text","code","view"],mode:"code",search:!1};m=new N(s,o),m?.set(l.tryParseJson(a.getText()))},closeDialog(){r.value.close()},saveJson(){a?.set(l.tryParseJson(m.getText()));const t=e.data,o=e.item.data.fieldName;t[o]=a?.getText(),r.value.close()}}}}),L={key:0,class:"item_require"},R=i("span",{class:"tip iconfont icon-tishi"},null,-1),U={id:"jsoneditor",ref:"jsoneditor"},X=i("i",{class:"iconfont icon-quanping"},null,-1),Y=[X],Z={ref:"JsonViewerDialogDom",style:{height:"calc(100% - 24px)"}};function A(e,c,m,a,u,r){const f=M,t=W,s=$,o=x,g=z,p=S("CustomDialog");return _(),y("div",{class:v(["starfish-formitem",{formCover:e.drag,"starfish-vertical":e.labelalign!="top",[e.item.data.csslist?.join(" ")]:!!e.item.data.csslist}])},[i("div",{class:v(["label","label_"+e.labelalign]),style:J({width:e.labelWidth+"px"})},[i("label",null,C(e.item.data.label)+C(e.suffix),1),e.item.data.required?(_(),y("span",L,"*")):D("",!0),e.item.data.tip?(_(),q(f,{key:1,class:"item",effect:"dark",content:e.item.data.tip,placement:"top"},{default:n(()=>[R]),_:1},8,["content"])):D("",!0)],6),i("div",{class:"control",style:J({marginLeft:e.labelalign!="top"?e.labelWidth+"px":""})},[i("div",U,[i("div",{class:"fullScreen",onClick:c[0]||(c[0]=(...E)=>e.showCustomDialog&&e.showCustomDialog(...E))},Y)],512)],4),d(p,{ref:"myDialog",width:"60%"},{default:n(()=>[d(t,{style:{padding:"0"}},{default:n(()=>[d(g,{style:{height:"100%"}},{default:n(()=>[d(t,{class:"my-pageMain"},{default:n(()=>[i("div",Z,null,512)]),_:1}),d(o,{class:"my-Footer",style:{height:"60px","padding-top":"10px","text-align":"right"}},{default:n(()=>[d(s,{type:"primary",onClick:e.saveJson},{default:n(()=>[w("保存")]),_:1},8,["onClick"]),d(s,{onClick:e.closeDialog},{default:n(()=>[w("关闭")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1},512)],2)}const K=P(O,[["render",A]]);export{K as default};
