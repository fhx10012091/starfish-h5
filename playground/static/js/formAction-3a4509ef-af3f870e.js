import{Y as j,d as M,i as T,r as g,$ as q,x as I,o as O,z as E,a as d,b as f,n as F,k as N,j as l,l as C,q as v,f as b,w as o,B as h,h as a,F as W,e as J,A as V,Z as L,E as R,a0 as U,M as H,v as K,a1 as Y,I as Z,J as G,K as P}from"./main-837926ce.js";/* empty css                */import{c as Q}from"./vue-codemirror.esm-21c23924.js";const X=M({ControlType:"FormAction",isHide:!0,components:{Codemirror:Q},props:{item:{type:Object,default:()=>({})},data:{type:Object,default:()=>({})},drag:{type:Boolean,default:!1},labelalign:{type:String,default:"top"},labelWidth:{type:Number},size:{type:String},isForm:{type:Boolean,default:!1}},setup(e){const{actionContrl:c}=T("control")||{},p=g(),{proxy:y}=q(),i=g(window.VApp.$Flex.deepClone(c?.get("action"))),s=g(window.VApp.$Flex.deepClone(c?.get("currentAction")));let _="";const m=I({funcName:[{required:!0,message:"函数名称必填",trigger:"change"}]});return console.log(e),O(()=>{}),{rules:m,actionRef:p,action:i,currentAction:s,getField(t){return window.VApp.$Flex.getField(t)},onAction(t){if(i.value=window.VApp.$Flex.deepClone(c?.get("action")),p.value.init("动作设置","icon-icon-bianji"),p.value.show(),t){_=t;const n=i.value.find(u=>{if(u.type==t)return u});n?s.value=n:y.addAction(t)}},onEditAction(t,n){_=t,i.value=window.VApp.$Flex.deepClone(c?.get("action")),p.value.init("动作设置","icon-icon-bianji"),p.value.show();const u=i.value.find(A=>{if(A.type==n)return A});u&&(s.value=u)},handleAction(t){s.value=t},onSave(){c?.set("action",i.value),p.value.close()},onCancel(){p.value.close()},copyAction(t){const n=window.VApp.$Flex.deepClone(t);n.funcName=n.funcName+"_copy",n.type=window.VApp.$Flex.generateMixed(5),i.value.push(n),s.value=n},deleteAction(t){i.value=i.value.filter(n=>{if(n.type!==t.type)return n}),s.value&&t.type==s.value.type&&(s.value=null)},addAction(t){const n={funcName:(t||"func")+"_"+window.VApp.$Flex.generateMixed(5),type:window.VApp.$Flex.generateMixed(5),funcStr:"",methods:t};i.value.push(n),t&&(s.value=n)},onConfirm(){e.data[e.item.data.fieldName]||(e.data[e.item.data.fieldName]={}),e.data[e.item.data.fieldName][_]=JSON.stringify(s.value),y.onSave()}}}}),x={key:0,class:"item_require"},ee=l("span",{class:"tip iconfont icon-tishi"},null,-1),te={class:"common-layout"},ne={class:"action-header"},oe={class:"action-list"},ae=["onClick"],le=l("span",{class:"event-script-menu-i"},"Function",-1),ie={class:"event-script-menu-label"},se={key:0,class:"event-script-menu-action"},ce=["onClick"],ue=["onClick"],re={class:"action-header event-script-main-header"},de={class:"coding"},pe={class:"header"},me=l("div",{class:"footer"},"}",-1);function fe(e,c,p,y,i,s){const _=L,m=R,t=U,n=H,u=K,A=Y,B=Z,k=G,$=E("codemirror"),S=P,z=E("CustomDialog");return d(),f("div",{class:F(["starfish-formitem",{formCover:e.drag,"starfish-vertical":e.labelalign!="top",[e.item.data.csslist?.join(" ")]:!!e.item.data.csslist}])},[e.isForm?v("",!0):(d(),f("div",{key:0,class:F(["label","label_"+e.labelalign]),style:N({width:e.labelWidth+"px"})},[l("label",null,C(e.item.data.label),1),e.item.data.required?(d(),f("span",x,"*")):v("",!0),e.item.data.tip?(d(),b(_,{key:1,class:"item",effect:"dark",content:e.item.data.tip,placement:"top"},{default:o(()=>[ee]),_:1},8,["content"])):v("",!0)],6)),l("div",{class:"control",style:N({marginLeft:e.labelalign!="top"?e.labelWidth+"px":""})},[e.isForm?v("",!0):(d(),b(m,{key:0,style:{width:"100%"},onClick:e.onAction},{default:o(()=>[h(" 设置 ")]),_:1},8,["onClick"])),a(z,{ref:"actionRef"},{default:o(()=>[l("div",te,[a(u,{style:{height:"100%",border:"1px solid rgb(238, 238, 238)"}},{default:o(()=>[a(u,null,{default:o(()=>[a(A,{width:"300px",class:"event-script-aside"},{default:o(()=>[a(u,{class:"is-vertical"},{default:o(()=>[l("header",ne,[a(m,{type:"text",size:e.size,onClick:e.addAction},{default:o(()=>[h(" +添加动作")]),_:1},8,["size","onClick"])]),a(n,null,{default:o(()=>[a(t,null,{default:o(()=>[l("div",oe,[(d(!0),f(W,null,J(e.action,(r,D)=>(d(),f("div",{class:F(["action",e.currentAction&&r.type==e.currentAction.type?"selectAction":""]),key:D,onClick:w=>e.handleAction(r)},[le,l("div",ie,C(r.funcName),1),r.disabled?v("",!0):(d(),f("div",se,[l("i",{title:"复制",class:"iconfont icon-fuzhi",onClick:V(w=>e.copyAction(r),["stop"])},null,8,ce),l("i",{title:"删除",class:"iconfont icon-shanchu1",onClick:V(w=>e.deleteAction(r),["stop"])},null,8,ue)]))],10,ae))),128))])]),_:1})]),_:1})]),_:1})]),_:1}),a(n,{class:"event-script-main"},{default:o(()=>[a(u,{class:"is-vertical"},{default:o(()=>[l("header",re,[a(m,{type:"primary",onClick:e.onConfirm,size:"small"},{default:o(()=>[h("确定")]),_:1},8,["onClick"]),a(m,{type:"primary",onClick:e.onSave,size:"small"},{default:o(()=>[h("保存")]),_:1},8,["onClick"]),a(m,{onClick:e.onCancel,size:"small"},{default:o(()=>[h("取消")]),_:1},8,["onClick"])]),e.currentAction?(d(),b(n,{key:0,class:"func_main"},{default:o(()=>[a(t,null,{default:o(()=>[a(S,{model:e.currentAction,rules:e.rules},{default:o(()=>[a(k,{label:"Function Name",prop:"funcName"},{default:o(()=>[a(B,{modelValue:e.currentAction.funcName,"onUpdate:modelValue":c[0]||(c[0]=r=>e.currentAction.funcName=r),disabled:e.currentAction.disabled},null,8,["modelValue","disabled"])]),_:1}),a(k,{prop:"funcStr"},{default:o(()=>[l("div",de,[l("div",pe," function "+C(e.currentAction.funcName)+"("+C(e.getField(e.currentAction.methods))+"){ ",1),a($,{modelValue:e.currentAction.funcStr,"onUpdate:modelValue":c[1]||(c[1]=r=>e.currentAction.funcStr=r),placeholder:"",style:{height:"400px"},mode:"text/javascript",autofocus:!0,"indent-with-tab":!0,"tab-size":2},null,8,["modelValue"]),me])]),_:1})]),_:1},8,["model","rules"])]),_:1})]),_:1})):v("",!0)]),_:1})]),_:1})]),_:1})]),_:1})])]),_:1},512)],4)],2)}const Ae=j(X,[["render",fe]]);export{Ae as default};
