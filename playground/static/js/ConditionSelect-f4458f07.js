import{_ as A,d as M,r as h,x as J,y as O,t as B,z as S,a as s,f as m,h as n,w as r,b as v,F as E,e as g,q as C,A as j,B as w,s as I,C as z,j as q,G,H,I as K,J as P,K as Q,L as W,E as X,M as Y,N as Z,v as x}from"./main-837926ce.js";/* empty css                */import{E as ee,a as le}from"./el-table-column-213ae48b.js";const ae=M({props:{data:{type:Object,default(){return{}}},item:{type:Object,default(){return{}}}},emits:["change"],setup(i,{emit:D}){const p=h(),b=h(),c=h();function F(){var l,e;const o=(l=z)==null?void 0:l.get("allFormList"),d=[];(e=B(o))==null||e.forEach(y=>{window.VueContext.$Flex.getFormDataList(y,d,i.data.fieldName)}),c.value=d}const t=J({andData:[[]],logicList:[{value:"=",label:"等于"},{value:"!=",label:"不等于"}],typeList:[{value:"常量",label:"常量"}]});return{...O(t),fieldList:c,maxJsonDialog:p,formList:b,handleType(l,e,o){o=="布尔"&&(t.andData[e][l].value=!0)},getLogic(l,e){const o=c.value.find(d=>{if(t.andData[e][l]&&d.value==t.andData[e][l].field)return d});return o&&o.options&&o.multiple?[{value:"in",label:"包含"},{value:"not in",label:"不包含"}]:o&&o.switch?[{value:"=",label:"等于"}]:t.logicList},getFiled(l,e){return!t.andData[e][l]||!t.andData[e][l].field?[]:c.value.find(d=>{if(t.andData[e][l]&&d.value==t.andData[e][l].field)return d}).options||[]},show(){p.value.init("可用条件","icon-icon-bianji"),p.value.show(),console.log(i.data),typeof i.data.showRule!="string"&&Array.isArray(i.data.showRule)?t.andData=i.data.showRule:t.andData=[[]],F()},getMultiple(l,e){return!!c.value.find(d=>{if(t.andData[e][l]&&d.value==t.andData[e][l].field)return d}).multiple},getNewTypeList(l,e){const o=c.value.find(d=>{if(t.andData[e][l]&&d.value==t.andData[e][l].field)return d});return o&&o.options?[{rule:[],value:"选项",label:"选项"}]:o&&o.switch?[{value:"布尔",label:"布尔"}]:t.typeList},deleteRow(l,e){t.andData[e].splice(l,1)},getTypeIsChange(l,e){return!!t.andData[e][l].type},getRules(l){var e;return{value:(e=t.typeList.find(o=>o.value==l))==null?void 0:e.rule}},async onAddItem(l){t.andData[l].push({field:"",logic:"",type:"",value:""})},onOrItem(){t.andData.push([])},closeDialog(){p.value.close()},saveJson(){const l=B(t.andData).filter(e=>{if(e.length>0)return e}).map(e=>{const o=e.filter(d=>{if(d.field)return d});if(o.length>0)return o}).filter(e=>!!e);D("change",l),p.value.close()}}}}),te=q("div",{class:"tipContent"},"满足以下所有条件时,此组件可用",-1);function ue(i,D,p,b,c,F){const t=G,l=H,e=ee,o=K,d=P,y=Q,k=W,_=X,L=le,V=Y,$=Z,R=x,U=S("CustomDialog");return s(),m(I,{to:"body"},[n(U,{ref:"maxJsonDialog",dialogclass:"conditionSelectNormal"},{default:r(()=>[n(V,{style:{padding:"0"}},{default:r(()=>[n(R,{style:{height:"100%"}},{default:r(()=>[n(V,{class:"my-pageMain"},{default:r(()=>[te,(s(!0),v(E,null,g(i.andData,(T,f)=>(s(),v("div",{class:"tableContainer",key:f},[n(L,{data:T,style:{width:"100%"},border:""},{default:r(()=>[n(e,{prop:"field",label:"字段"},{default:r(a=>[n(l,{modelValue:a.row.field,"onUpdate:modelValue":u=>a.row.field=u,placeholder:"请选择"},{default:r(()=>[(s(!0),v(E,null,g(i.fieldList,u=>(s(),m(t,{key:u.value,label:u.label,value:u.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1}),n(e,{prop:"logic",label:"逻辑"},{default:r(a=>[n(l,{modelValue:a.row.logic,"onUpdate:modelValue":u=>a.row.logic=u,placeholder:"请选择"},{default:r(()=>[(s(!0),v(E,null,g(i.getLogic(a.$index,f),u=>(s(),m(t,{key:u.value,label:u.label,value:u.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024),n(e,{prop:"type",label:"值类型"},{default:r(a=>[n(l,{modelValue:a.row.type,"onUpdate:modelValue":u=>a.row.type=u,placeholder:"请选择",onChange:u=>i.handleType(a.$index,f,a.row.type)},{default:r(()=>[(s(!0),v(E,null,g(i.getNewTypeList(a.$index,f),u=>(s(),m(t,{key:u.value,label:u.label,value:u.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),_:2},1024),n(e,{prop:"value",label:"值"},{default:r(a=>[i.getTypeIsChange(a.$index,f)&&a.row.type=="常量"?(s(),m(y,{key:0,model:a.row,rules:i.getRules(a.row.type),ref_for:!0,ref:"formList"},{default:r(()=>[n(d,{prop:"value"},{default:r(()=>[n(o,{text:"",modelValue:a.row.value,"onUpdate:modelValue":u=>a.row.value=u},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1032,["model","rules"])):C("",!0),a.row.type=="选项"?(s(),m(l,{key:1,modelValue:a.row.value,"onUpdate:modelValue":u=>a.row.value=u,filterable:"",placeholder:"请选择",multiple:i.getMultiple(a.$index,f)},{default:r(()=>[n(t,{label:"未选择",value:""}),(s(!0),v(E,null,g(i.getFiled(a.$index,f),(u,N)=>(s(),m(t,{key:N,label:u.label,value:u.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","multiple"])):C("",!0),a.row.type=="布尔"?(s(),m(k,{key:2,modelValue:a.row.value,"onUpdate:modelValue":u=>a.row.value=u},null,8,["modelValue","onUpdate:modelValue"])):C("",!0)]),_:2},1024),n(e,{fixed:"right",label:"操作",width:"100"},{default:r(a=>[n(_,{size:"small",type:"danger",onClick:j(u=>i.deleteRow(a.$index,f),["prevent"])},{default:r(()=>[w(" 删除 ")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["data"]),n(_,{class:"mt-4",style:{width:"100%"},text:"",onClick:a=>i.onAddItem(f)},{default:r(()=>[w("+并条件")]),_:2},1032,["onClick"])]))),128)),n(_,{class:"mt-4",text:"",onClick:i.onOrItem},{default:r(()=>[w("+或条件")]),_:1},8,["onClick"])]),_:1}),n($,{class:"my-Footer",style:{height:"60px","padding-top":"10px","text-align":"right"}},{default:r(()=>[n(_,{type:"primary",onClick:i.saveJson},{default:r(()=>[w("保存")]),_:1},8,["onClick"]),n(_,{onClick:i.closeDialog},{default:r(()=>[w("关闭")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1},512)])}var ie=A(ae,[["render",ue]]);export{ie as default};
